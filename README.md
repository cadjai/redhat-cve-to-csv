# redhat-cve-to-csv
This repository contains helper playbook to pull Red Hat CVE data from the Red Hat CVE Database and generate a CSV file that can then be used with some excel lookup functions to provided answers to various security group when answers are needed due to CVE being reported during a security scan. The playbook expect the list of CVE (in comma separated list or in line separeted file).   


## Requirements

As mentioned above the list of CVE to use should be passed as either a comma separeted yaml variable or a line separeted file (where each CVE is listed on a line) .  
The playbook here only require ansible to run but python and jq are expected on the controler host. 

## Cloning the repository
1. Use `git clone https://github.com/cadjai/redhat-cve-to-csv.git` to clone the repository
2. USe `cd redhat-cve-to-csv` to change directory into the location of the playbook. 

## Running the playbooks 
1. To generate CVE data using either the cve_file or the cve_list variable , run the playbook using the following command.   
   ```
   ansible-playbook generate-cve-data-csv.yml -e cve_file=<path-to-cve-file> -e cve_data_result_file=<path-to-CSV-output-file> -vvv

   ansible-playbook generate-cve-data-csv.yml -e '{"cve_list": [CVE-2022-1280]}' -e cve_data_result_file=/tmp/CVE-2022-1280-cve-results.csv -vvv
   ``` 
Note: You can either use cve_file or cve_list to provide the list of CVE to generate the CSV file for.   

2. To generate CVE data using RHSAs through rhsa_file or rhsa_list variable, run the playbook using one of the following commands. Note that this was only introduced with the v2.0 version
   ```
   ansible-playbook generate-cve-data-csv.yml -e rhsa_file=<path-to-cve-file> -e cve_data_result_file=<path-to-CSV-output-file> -vvv

   ansible-playbook generate-cve-data-csv.yml -e '{"rhsa_list": [RHSA-2022:3614,RHSA-2022:1642]}' -e cve_data_result_file=/tmp/RHSA-2022-cve-results.csv -vvv
   ``` 

## Playbook Variables

### cve_file
Required: Conditionally   
The file containing the list of CVEs to query and generate the CSV file for. Only required if the list is not provided as a yaml or comma separeted variable.   

### cve_list
Required: Conditionally   
The variable containing the list of CVEs to query and generate the CSV file for. Only required if the list is not provided as a line separeted flat file .   

### cve_data_result_file 
Optional:    
Default: '/tmp/cve-data-results.csv'   
The name and location of the CSV output file generated by the playbook.    

### cve_data_api_url 
Optional:    
Default: 'https://access.redhat.com/hydra/rest/securitydata/cve'   
The URL of the Red Hat CVE Database API to use to query the CVE data for each of the CVE in the list provided above . 

### rhsa_file 
Required: Conditionally   
The file containing the list of RHSAs to query and generate the CSV file for. Only required if the list (of CVEs or RHSAs) is not provided as a yaml or comma separeted variable.   
Note: If running the retrieve-cve-data-for-rhsa-txt.yml by itself to generate a line separated list of CVEs of a list of RHSAs then this become required if the rhsa_list is not set. 

### rhsa_list
Required: Conditionally   
The variable containing the list of RHSAs to query and generate the CSV file for. Only required if the list is not provided as a line separeted flat file .   
Note: If running the retrieve-cve-data-for-rhsa-txt.yml by itself to generate a line separated list of CVEs of a list of RHSAs then this become required if the rhsa_file is not set. 

